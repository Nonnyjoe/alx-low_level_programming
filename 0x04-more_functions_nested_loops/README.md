this is a continuation of function and nested loops
